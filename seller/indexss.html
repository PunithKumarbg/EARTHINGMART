<!-- <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Seller | Light Connect</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container mt-5">
  <h2 class="text-center mb-4 text-success">üè™ Seller Dashboard</h2>

  <!-- Login/Register -->
  <div id="authSection" class="card p-4 mb-4 shadow-sm">
    <h5 class="mb-3 text-center">Login or Register</h5>
    <div class="mb-3">
      <input type="email" id="sellerEmail" class="form-control" placeholder="Email">
    </div>
    <div class="mb-3">
      <input type="password" id="sellerPassword" class="form-control" placeholder="Password">
    </div>
    <div class="d-grid gap-2">
      <button class="btn btn-success" onclick="sellerLogin()">Login</button>
      <button class="btn btn-outline-success" onclick="sellerRegister()">Register</button>
    </div>
  </div>

  <!-- Pending Requests -->
  <div id="requestSection" class="card p-4 mb-4 d-none shadow-sm">
    <h5 class="mb-3">Pending Buyer Requests</h5>
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Product</th>
          <th>Qty</th>
          <th>City</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody id="requestsTable"></tbody>
    </table>
    <div class="text-end mt-3">
      <button class="btn btn-sm btn-danger" onclick="logout()">Logout</button>
    </div>
  </div>

  <!-- Offer Modal -->
  <div class="modal fade" id="offerModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Submit Offer</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <input type="hidden" id="offerRequestId">
          <div class="mb-2">
            <input type="number" id="offerPrice" class="form-control" placeholder="Price in ‚Çπ">
          </div>
          <div class="mb-2">
            <input type="text" id="offerTimeline" class="form-control" placeholder="Timeline (e.g., 3 days)">
          </div>
          <div class="mb-2">
            <textarea id="offerMessage" class="form-control" placeholder="Additional message"></textarea>
          </div>
          <button class="btn btn-success w-100" onclick="submitOffer()">Submit Offer</button>
        </div>
      </div>
    </div>
  </div>

</div>

<!-- Firebase & Bootstrap Scripts -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
<script src="../firebase-config.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
let currentUser = null;
const offerModal = new bootstrap.Modal(document.getElementById('offerModal'));

// Auth state listener
firebase.auth().onAuthStateChanged(user => {
  if (user) {
    currentUser = user;
    document.getElementById('authSection').classList.add('d-none');
    document.getElementById('requestSection').classList.remove('d-none');
    loadPendingRequests();
  } else {
    currentUser = null;
    document.getElementById('authSection').classList.remove('d-none');
    document.getElementById('requestSection').classList.add('d-none');
  }
});

// Register/Login functions
function sellerRegister() {
  const email = sellerEmail.value;
  const pass = sellerPassword.value;
  auth.createUserWithEmailAndPassword(email, pass)
    .then(() => alert('‚úÖ Registered Successfully'))
    .catch(err => alert(err.message));
}

function sellerLogin() {
  const email = sellerEmail.value;
  const pass = sellerPassword.value;
  auth.signInWithEmailAndPassword(email, pass)
    .then(() => console.log('Logged In'))
    .catch(err => alert(err.message));
}

function logout() {
  auth.signOut();
}

// Load all pending requests
function loadPendingRequests() {
  db.collection('requests')
    .where('status', '==', 'Pending')
    .orderBy('createdAt', 'desc')
    .onSnapshot(snapshot => {
      const tbody = document.getElementById('requestsTable');
      tbody.innerHTML = '';
      snapshot.forEach(doc => {
        const data = doc.data();
        tbody.innerHTML += `
          <tr>
            <td>${data.product}</td>
            <td>${data.qty}</td>
            <td>${data.city}</td>
            <td>
              <button class="btn btn-sm btn-success" onclick="openOfferModal('${doc.id}')">Make Offer</button>
            </td>
          </tr>
        `;
      });
    });
}

// Open offer modal
function openOfferModal(requestId) {
  document.getElementById('offerRequestId').value = requestId;
  offerModal.show();
}

// Submit offer
function submitOffer() {
  const requestId = document.getElementById('offerRequestId').value;
  const price = document.getElementById('offerPrice').value;
  const timeline = document.getElementById('offerTimeline').value;
  const message = document.getElementById('offerMessage').value;

  if (!price || !timeline) {
    alert('‚ö†Ô∏è Price and timeline are required');
    return;
  }

  db.collection('offers').add({
    requestId,
    sellerId: currentUser.uid,
    price: Number(price),
    timeline,
    message,
    status: 'Pending',
    createdAt: firebase.firestore.FieldValue.serverTimestamp()
  }).then(() => {
    offerModal.hide();
    document.getElementById('offerPrice').value = '';
    document.getElementById('offerTimeline').value = '';
    document.getElementById('offerMessage').value = '';
    alert('‚úÖ Offer submitted successfully!');
  }).catch(err => alert('‚ùå ' + err.message));
}
</script>

</body>
</html> -->
